<?php 
function cetGetMetaKeywordsFromText ($str) {
    $skip_words = array(
        // prepositions
        'aboard', 'about', 'above', 'across', 'after', 'against', 'along', 'amid', 'among', 'anti', 'around', 'as', 'at', 'before', 'behind', 'below', 'beneath', 'beside', 'besides', 'between', 'beyond', 'but', 'by', 'concerning', 'considering', 'despite', 'down', 'during', 'except', 'excepting', 'excluding', 'following', 'for', 'from', 'in', 'inside', 'into', 'like', 'minus', 'near', 'of', 'off', 'on', 'onto', 'opposite', 'outside', 'over', 'past', 'per', 'plus', 'regarding', 'round', 'save', 'since', 'than', 'through', 'to', 'toward', 'towards', 'under', 'underneath', 'unlike', 'until', 'up', 'upon', 'versus', 'via', 'with', 'within', 'without',
        // articles
        'a', 'the', 'an',
        // pronouns
        'all', 'another', 'any', 'anybody', 'anyone', 'anything', 'both', 'each', 'each other', 'either', 'everybody', 'everyone', 'everything', 'few', 'he', 'her', 'hers', 'herself', 'him', 'himself', 'his', 'I', 'it', 'its', 'itself', 'little', 'many', 'me', 'mine', 'more', 'most', 'much', 'my', 'myself', 'neither', 'no one', 'nobody', 'none', 'nothing', 'one', 'one another', 'other', 'others', 'our', 'ours', 'ourselves', 'several', 'she', 'some', 'somebody', 'someone', 'something', 'that', 'their', 'theirs', 'them', 'themselves', 'these', 'they', 'this', 'those', 'us', 'we', 'what', 'whatever', 'which', 'whichever', 'who', 'whoever', 'whom', 'whomever', 'whose', 'you', 'your', 'yours', 'yourself', 'yourselves',
        // conjunctions
        'and', 'but', 'or', 'nor', 'for', 'yet', 'so', 'although', 'because', 'since', 'unless',
        // adverbs
        'aboard', 'abnormally', 'about', 'abroad', 'absentmindedly', 'absolutely', 'abundantly', 'accidentally', 'accordingly', 'actively', 'actually', 'acutely', 'admiringly', 'affectionately', 'affirmatively', 'after', 'afterwards', 'agreeably', 'almost', 'already', 'always', 'amazingly', 'angrily', 'annoyingly', 'annually', 'anxiously', 'anyhow', 'anyplace', 'anyway', 'anywhere', 'appreciably', 'appropriately', 'around', 'arrogantly', 'aside', 'assuredly', 'astonishingly', 'away', 'awfully', 'awkwardly', 'badly', 'barely', 'bashfully', 'beautifully', 'before', 'begrudgingly', 'believably', 'bewilderedly', 'bewilderingly', 'bitterly', 'bleakly', 'blindly', 'blissfully', 'boldly', 'boastfully', 'boldly', 'boyishly', 'bravely', 'briefly', 'brightly', 'brilliantly', 'briskly', 'brutally', 'busily', 'calmly', 'candidly', 'carefully', 'carelessly', 'casually', 'cautiously', 'certainly', 'charmingly', 'cheerfully', 'chiefly', 'childishly', 'cleanly', 'clearly', 'cleverly', 'closely', 'cloudily', 'clumsily', 'coaxingly', 'coincidentally', 'coldly', 'colorfully', 'commonly', 'comfortably', 'compactly', 'compassionately', 'completely', 'confusedly', 'consequently', 'considerably', 'considerately', 'consistently', 'constantly', 'continually', 'continuously', 'coolly', 'correctly', 'courageously', 'covertly', 'cowardly', 'crazily', 'crossly', 'cruelly', 'cunningly', 'curiously', 'currently', 'customarily', 'cutely', 'daily', 'daintily', 'dangerously', 'daringly', 'darkly', 'dastardly', 'dearly', 'decently', 'deeply', 'defiantly', 'deftly', 'deliberately', 'delicately', 'delightfully', 'densely', 'diagonally', 'differently', 'diligently', 'dimly', 'directly', 'disorderly', 'divisively', 'docilely', 'dopily', 'doubtfully', 'down', 'dramatically', 'dreamily', 'during', 'eagerly', 'early', 'earnestly', 'easily', 'efficiently', 'effortlessly', 'elaborately', 'eloquently', 'elegantly', 'elsewhere', 'emotionally', 'endlessly', 'energetically', 'enjoyably', 'enormously', 'enough', 'enthusiastically', 'entirely', 'equally', 'especially', 'essentially', 'eternally', 'ethically', 'even', 'evenly', 'eventually', 'evermore', 'every', 'everywhere', 'evidently', 'evocatively', 'exactly', 'exceedingly', 'exceptionally', 'excitedly', 'exclusively', 'explicitly', 'expressly', 'extensively', 'externally', 'extra', 'extraordinarily', 'extremely', 'fairly', 'faithfully', 'famously', 'far', 'fashionably', 'fast', 'fatally', 'favorably', 'ferociously', 'fervently', 'fiercely', 'fiery', 'finally', 'financially', 'finitely', 'fluently', 'fondly', 'foolishly', 'forever', 'formally', 'formerly', 'fortunately', 'forward', 'frankly', 'frantically', 'freely', 'frequently', 'frenetically', 'fully', 'furiously', 'furthermore', 'generally', 'generously', 'genuinely', 'gently', 'genuinely', 'girlishly', 'gladly', 'gleefully', 'gracefully', 'graciously', 'gradually', 'gratefully', 'greatly', 'greedily', 'grimly', 'grudgingly', 'habitually', 'half-heartedly', 'handily', 'handsomely', 'haphazardly', 'happily', 'hastily', 'harmoniously', 'harshly', 'hastily', 'hatefully', 'hauntingly', 'healthily', 'heartily', 'heavily', 'helpfully', 'hence', 'highly', 'hitherto', 'honestly', 'hopelessly', 'horizontally', 'hourly', 'how', 'however', 'hugely', 'humorously', 'hungrily', 'hurriedly', 'hysterically', 'icily', 'identifiably', 'idiotically', 'imaginatively', 'immeasurably', 'immediately', 'immensely', 'impatiently', 'impressively', 'inappropriately', 'incessantly', 'incorrectly', 'indeed', 'independently', 'indoors', 'indubitably', 'inevitably', 'infinitely', 'informally', 'infrequently', 'innocently', 'inquisitively', 'instantly', 'intelligently', 'intensely', 'intently', 'interestingly', 'intermittently', 'internally', 'invariably', 'invisibly', 'inwardly', 'ironically', 'irrefutably', 'irritably', 'jaggedly', 'jauntily', 'jealously', 'jovially', 'joyfully', 'joylessly', 'joyously', 'jubilantly', 'judgmentally', 'just', 'justly', 'keenly', 'kiddingly', 'kindheartedly', 'kindly', 'knavishly', 'knottily', 'knowingly', 'knowledgeably', 'kookily', 'lastly', 'late', 'lately', 'later', 'lazily', 'less', 'lightly', 'likely', 'limply', 'lithely', 'lively', 'loftily', 'longingly', 'loosely', 'loudly', 'lovingly', 'loyally', 'luckily', 'luxuriously', 'madly', 'magically', 'mainly', 'majestically', 'markedly', 'materially', 'meaningfully', 'meanly', 'meantime', 'meanwhile', 'measurably', 'mechanically', 'medically', 'menacingly', 'merely', 'merrily', 'methodically', 'mightily', 'miserably', 'mockingly', 'monthly', 'morally', 'more', 'moreover', 'mortally', 'mostly', 'much', 'mysteriously', 'nastily', 'naturally', 'naughtily', 'nearby', 'nearly', 'neatly', 'needily', 'negatively', 'nervously', 'never', 'nevertheless', 'next', 'nicely', 'nightly', 'noisily', 'normally', 'nosily', 'not', 'now', 'nowadays', 'numbly', 'obediently', 'obligingly', 'obnoxiously', 'obviously', 'occasionally', 'oddly', 'offensively', 'officially', 'often', 'ominously', 'once', 'only', 'openly', 'optimistically', 'orderly', 'ordinarily', 'outdoors', 'outrageously', 'outwardly', 'outwards', 'overconfidently', 'overseas', 'painfully', 'painlessly', 'paradoxically', 'partially', 'particularly', 'passionately', 'patiently', 'perfectly', 'periodically', 'perpetually', 'persistently', 'personally', 'persuasively', 'physically', 'plainly', 'playfully', 'poetically', 'poignantly', 'politely', 'poorly', 'positively', 'possibly', 'potentially', 'powerfully', 'presently', 'presumably', 'prettily', 'previously', 'primly', 'principally', 'probably', 'promptly', 'properly', 'proudly', 'punctually', 'puzzlingly', 'quaintly', 'queasily', 'questionably', 'questioningly', 'quicker', 'quickly', 'quietly', 'quirkily', 'quite', 'quizzically', 'randomly', 'rapidly', 'rarely', 'readily', 'really', 'reasonably', 'reassuringly', 'recently', 'recklessly', 'regularly', 'reliably', 'reluctantly', 'remarkably', 'repeatedly', 'reproachfully', 'reponsibly', 'resentfully', 'respectably', 'respectfully', 'restfully', 'richly', 'ridiculously', 'righteously', 'rightfully', 'rightly', 'rigidly', 'roughly', 'routinely', 'rudely', 'ruthlessly', 'sadly', 'safely', 'scarcely', 'scarily', 'scientifically', 'searchingly', 'secretively', 'securely', 'sedately', 'seemingly', 'seldom', 'selfishly', 'selflessly', 'separately', 'seriously', 'shakily', 'shamelessly', 'sharply', 'sheepishly', 'shoddily', 'shortly', 'shrilly', 'significantly', 'silently', 'simply', 'sincerely', 'singularly', 'shyly', 'skillfully', 'sleepily', 'slightly', 'slowly', 'slyly', 'smoothly', 'so', 'softly', 'solely', 'solemnly', 'solidly', 'silicitiously', 'somehow', 'sometimes', 'somewhat', 'somewhere', 'soon', 'specially', 'specifically', 'spectacularly', 'speedily', 'spiritually', 'splendidly', 'sporadically', 'spasmodically', 'startlingly', 'steadily', 'stealthily', 'sternly', 'still', 'strenuously', 'stressfully', 'strictly', 'structurally', 'studiously', 'stupidly', 'stylishly', 'subsequently', 'substantially', 'subtly', 'successfully', 'suddenly', 'sufficiently', 'suitably', 'superficially', 'supremely', 'surely', 'surprisingly', 'suspiciously', 'sweetly', 'swiftly', 'sympathetically', 'systematically', 'temporarily', 'tenderly', 'tensely', 'tepidly', 'terribly', 'thankfully', 'then', 'there', 'thereby', 'thoroughly', 'thoughtfully', 'thus', 'tightly', 'today', 'together', 'tomorrow', 'too', 'totally', 'touchingly', 'tremendously', 'truly', 'truthfully', 'twice', 'ultimately', 'unabashedly', 'unanimously', 'unbearably', 'unbelievably', 'unemotionally', 'unethically', 'unexpectedly', 'unfailingly', 'unfavorably', 'unfortunately', 'uniformly', 'unilaterally', 'unimpressively', 'universally', 'unnaturally', 'unnecessarily', 'unquestionably', 'unwillingly', 'up', 'upbeat', 'unkindly', 'upliftingly', 'upright', 'unselfishly', 'upside-down', 'unskillfully', 'upward', 'upwardly', 'urgently', 'usefully', 'uselessly', 'usually', 'utterly', 'vacantly', 'vaguely', 'vainly', 'valiantly', 'vastly', 'verbally', 'vertically', 'very', 'viciously', 'victoriously', 'vigilantly', 'vigorously', 'violently', 'visibly', 'visually', 'vivaciously', 'voluntarily', 'warmly', 'weakly', 'wearily', 'weekly', 'well', 'wetly', 'when', 'where', 'while', 'whole-heartedly', 'wholly', 'why', 'wickedly', 'widely', 'wiggly', 'wildly', 'willfully', 'willingly', 'wisely', 'woefully', 'wonderfully', 'worriedly', 'worthily', 'wrongly', 'yearly', 'yearningly', 'yesterday', 'yet', 'youthfully', 'zanily', 'zealously', 'zestfully', 'zestily'
    );
    $str = preg_replace('/[,\.\?\/\*\-\\+=_\!\(\)@#$%&;:\'\"\[\]]/', '', $str);
    $str = preg_replace('/\b\d+\b/', '', $str);
    $words = explode(' ', $str);
    $result = array();
    foreach ($words as $word) {
      if (!in_array($word, $skip_words) && strlen($word) > 1) {
        $result[] = $word;
      }
    }

    $result = join(', ', $result);
    return $result;
}

function cetGetProductMetaKeywords ($post_id, $post_title) {
    global $aiosp;
    if (!is_single() || $aiosp->get_main_keywords()) return false;

    $result = cetGetMetaKeywordsFromText($post_title);
    $terms = get_the_terms($post_id, 'property-category');

    if ($terms) {
        foreach ($terms as $term) {
            $result .= ', ' . $term->name;
        }
    }
    return $result;
}